# DWH для нескольких источников

## Описание
В данном проекте реализуем витрину данных для службы доставки. Данные получаем из облачного ресурса яндекса.

В процессе создаем несколько слоев - stg, dds, cdm

## Структура проекта

В каталоге src/dags есть несколько каталогов.


 Каталог с файлом models.py, в котором перечислены классы объектов, используемых в проекте(выполнил в одном файле, но можно разделить):
 - models 
 
Каталог с .py файлами, в которых описывается процесс обработки данных для каждого слоя:
  - repositories

Каталог с sql скриптами для выполнения запросов в репозиториях:
 - sql 


В репозиториях есть несколько общих.

 Читает или вставляет данные в таблицу settings:
 - settings repository


Получение содержимого sql запроса:
 - query folder 

Репозиторий для вставки данных в конечнюу таблицу(например в dds слой). Используется обощенный тип, чтобы не плодить сущности:
 - origin repository


## Структура дагов

Процедура представлена 2 дагами:

 - delivery_service_dag

В этом даге выполняются загрузки в слой stg из облака, и обработка слоя stg для переноса данных в dds слой -  создание измерений и фактов. Запуск настроен на каждые 25 минут, но можно и чаще.

 - delivery_mart_dag

В этом даге выполняется загрузка данных в итоговую витрину, заданную в проекте. Запуск в моем случае решил сделать каждый день в 3 часа ночи.Но судя по описанию задания, нужно получать данные по курьерам за прошлый месяц. Поэтому есть более правильный вариант - запускать 1 раз в месяц 1 числа. К этому моменту будут закрыты все доставки из ресторанов и данные будут актуальны на весь месяц


## Несоответствия

Переносил проект с работающего airflow, там у меня были свои пути к файлам. в гите не стал менять. Например ссылки на классы в репозиториях - my_dags/project/models





